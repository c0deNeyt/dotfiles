# -- Color Support 
set -ga terminal-overrides ",screen-256color*:Tc"
set-option -g default-terminal "screen-256color"

# -- remove lag from pressing escape
set -s escape-time 0

# -- Checkge Ctrl + b to Ctrl + Space
set -g prefix C-Space
bind-key C-Space send-prefix

# -- Enter copy mode with escape
bind -n M-e copy-mode

# -- reload config
unbind r
bind r source-file ~/.config/tmux/tmux.conf \; display "Reloaded!"

# -- windows started from 1 instead of 0
set -g base-index 1

# -- Vim Mode 
set-window-option -g mode-keys vi

# -- Select a text or visual mode in vim 
bind -T copy-mode-vi v send-keys -X begin-selection
# -- Yank like in vim 
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# -- Vim motion
bind -T copy-mode-vi h send-keys -X cursor-left  
bind -T copy-mode-vi k send-keys -X cursor-up
bind -T copy-mode-vi l send-keys -X cursor-right
bind -T copy-mode-vi j send-keys -X cursor-down

# vim-like pane switching
bind -r ^ last-window
bind -r k select-pane -U
bind -r j select-pane -D
bind -r h select-pane -L
bind -r l select-pane -R

# -- tmux color theme plugin
run ~/.config/tmux/plugins/catppuccin/tmux/catppuccin.tmux

set -g @catppuccin_flavor "macchiato"

# ===========================
# Green Theme for tmux
# Matched to ~/.Xresources
# ===========================

# Base layers
set -g @ctp_bg "#0d1f0d"          # background
set -g @ctp_surface_1 "#1a2f1a"   # surface / border
set -g @ctp_crust "#0a160a"       # darkest crust

# Text and accents
set -g @ctp_fg "#d0e1d0"          # foreground text
set -g @ctp_mauve "#4dd64d"       # accent green (like active window)

# (Optional additional tones)
set -g @ctp_surface_2 "#4a6b4a"  # optional highlight border tone
set -g @ctp_yellow "#a8cc3a"
set -g @ctp_blue "#3a9d8f"
set -g @ctp_cyan "#3acc8f"

# status line
set -gF status-style "bg=#{@ctp_bg},fg=#{@ctp_fg}"

# windows
set -gF window-status-format "#[bg=#{@ctp_surface_1},fg=#{@ctp_fg}] ##I ##T "
set -gF window-status-current-format "#[bg=#{@ctp_mauve},fg=#{@ctp_crust}] ##I ##T "
set -g focus-events on
set -g status-style bg=default
set -g status-left-length 99
set -g status-right-length 99
set -g status-justify centre

# Use XDG path for plugins
set-environment -g TMUX_PLUGIN_MANAGER_PATH '~/.config/tmux/plugins'

# TPM
set -g @plugin 'tmux-plugins/tpm'
# Save/restore
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Auto-restore the last saved state when tmux starts
set -g @continuum-restore 'on'

# (Optional niceties)
set -g @resurrect-capture-pane-contents 'on'   # save scrollback text
set -g @resurrect-dir '~/.tmux/resurrect'     # custom save dir if you want

# forget the find window.  That is for chumps
bind-key -r f run-shell "tmux neww ~/.local/bin/tmux-sessionizer"

# TPM bootstrap
# Load TPM
run -b '~/.config/tmux/plugins/tpm/tpm'

